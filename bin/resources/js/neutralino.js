var Neutralino=function(e){"use strict";function t(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{s(i.next(e))}catch(e){o(e)}}function u(e){try{s(i.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((i=i.apply(e,t||[])).next())}))}function n(e,t){return new Promise(((n,i)=>{let r=new CustomEvent(e,{detail:t});window.dispatchEvent(r),n()}))}var i,r=Object.freeze({__proto__:null,on:function(e,t){return new Promise(((n,i)=>{window.addEventListener(e,t),n()}))},off:function(e,t){return new Promise(((n,i)=>{window.removeEventListener(e,t),n()}))},dispatch:n});function o(e){return new Promise(((i,r)=>{e.isNativeMethod&&(e.url="http://localhost:"+window.NL_PORT+"/__nativeMethod_"+e.url),e.data&&(e.data=JSON.stringify(e.data));let o=new Headers;o.append("Content-Type","application/json"),o.append("Authorization","Basic "+window.NL_TOKEN),fetch(e.url,{method:e.type,headers:o,body:e.data}).then((e=>t(this,void 0,void 0,(function*(){let t=yield e.text(),n=null;t&&(n=JSON.parse(t)),n&&n.success&&i(n.hasOwnProperty("returnValue")?n.returnValue:n),n&&n.error&&r(n.error)})))).catch((e=>{let t={code:"NE_CL_NSEROFF",message:"Neutralino server is offline. Try restarting the application"};n("serverOffline",t),r(t)}))}))}!function(e){e.GET="GET",e.POST="POST"}(i||(i={}));var a,u=Object.freeze({__proto__:null,createDirectory:function(e){return o({url:"filesystem.createDirectory",type:i.POST,data:{path:e},isNativeMethod:!0})},removeDirectory:function(e){return o({url:"filesystem.removeDirectory",type:i.POST,data:{path:e},isNativeMethod:!0})},writeFile:function(e,t){return o({url:"filesystem.writeFile",type:i.POST,data:{path:e,data:t},isNativeMethod:!0})},writeBinaryFile:function(e,t){let n=new Uint8Array(t),r="";for(let e of n)r+=String.fromCharCode(e);return o({url:"filesystem.writeBinaryFile",type:i.POST,data:{path:e,data:window.btoa(r)},isNativeMethod:!0})},readFile:function(e){return o({url:"filesystem.readFile",type:i.POST,data:{path:e},isNativeMethod:!0})},readBinaryFile:function(e){return new Promise(((t,n)=>{o({url:"filesystem.readBinaryFile",type:i.POST,data:{path:e},isNativeMethod:!0}).then((e=>{let n=window.atob(e),i=n.length,r=new Uint8Array(i);for(let e=0;e<i;e++)r[e]=n.charCodeAt(e);t(r.buffer)})).catch((e=>{n(e)}))}))},removeFile:function(e){return o({url:"filesystem.removeFile",type:i.POST,data:{path:e},isNativeMethod:!0})},readDirectory:function(e){return o({url:"filesystem.readDirectory",type:i.POST,data:{path:e},isNativeMethod:!0})},copyFile:function(e,t){return o({url:"filesystem.copyFile",type:i.POST,data:{source:e,destination:t},isNativeMethod:!0})},moveFile:function(e,t){return o({url:"filesystem.moveFile",type:i.POST,data:{source:e,destination:t},isNativeMethod:!0})},getStats:function(e){return o({url:"filesystem.getStats",type:i.POST,data:{path:e},isNativeMethod:!0})}});!function(e){e.WARN="WARN",e.ERROR="ERROR",e.INFO="INFO",e.QUESTION="QUESTION"}(a||(a={}));var s=Object.freeze({__proto__:null,get MessageBoxType(){return a},execCommand:function(e,t){return o({url:"os.execCommand",type:i.POST,data:Object.assign({command:e},t),isNativeMethod:!0})},getEnv:function(e){return o({url:"os.getEnv",type:i.POST,data:{key:e},isNativeMethod:!0})},showOpenDialog:function(e,t){return o({url:"os.showOpenDialog",type:i.POST,data:Object.assign({title:e},t),isNativeMethod:!0})},showSaveDialog:function(e){return o({url:"os.showSaveDialog",type:i.POST,data:{title:e},isNativeMethod:!0})},showNotification:function(e,t){return o({url:"os.showNotification",type:i.POST,data:{title:e,content:t},isNativeMethod:!0})},showMessageBox:function(e,t,n){return o({url:"os.showMessageBox",type:i.POST,data:{title:e,content:t,type:n},isNativeMethod:!0})},setTray:function(e){return o({url:"os.setTray",type:i.POST,data:e,isNativeMethod:!0})},open:function(e){return o({url:"os.open",type:i.POST,data:{url:e},isNativeMethod:!0})}});var d=Object.freeze({__proto__:null,getMemoryInfo:function(){return o({url:"computer.getMemoryInfo",type:i.GET,isNativeMethod:!0})}});var l,c=Object.freeze({__proto__:null,setData:function(e,t){return o({url:"storage.setData",type:i.POST,data:{key:e,data:t},isNativeMethod:!0})},getData:function(e){return o({url:"storage.getData",type:i.POST,data:{key:e},isNativeMethod:!0})}});!function(e){e.WARNING="WARNING",e.ERROR="ERROR",e.INFO="INFO"}(l||(l={}));var p=Object.freeze({__proto__:null,get LoggerType(){return l},log:function(e,t){return o({url:"debug.log",type:i.POST,data:{message:e,type:t},isNativeMethod:!0})}});function f(){return o({url:"app.keepAlive",type:i.GET,isNativeMethod:!0})}var v=Object.freeze({__proto__:null,exit:function(e){return o({url:"app.exit",type:i.POST,data:{code:e},isNativeMethod:!0})},killProcess:function(){return o({url:"app.killProcess",type:i.GET,isNativeMethod:!0})},restartProcess:function(){return new Promise(((e,n)=>t(this,void 0,void 0,(function*(){let t=window.NL_ARGS.reduce(((e,t,n)=>e+=" "+t),"");yield Neutralino.os.execCommand(t,{shouldRunInBackground:!0}),Neutralino.app.exit(),e()}))))},keepAlive:f,getConfig:function(){return o({url:"app.getConfig",type:i.GET,isNativeMethod:!0})}});var h=Object.freeze({__proto__:null,setTitle:function(e){return o({url:"window.setTitle",type:i.POST,data:{title:e},isNativeMethod:!0})},maximize:function(){return o({url:"window.maximize",type:i.GET,isNativeMethod:!0})},unmaximize:function(){return o({url:"window.unmaximize",type:i.GET,isNativeMethod:!0})},isMaximized:function(){return o({url:"window.isMaximized",type:i.GET,isNativeMethod:!0})},minimize:function(){return o({url:"window.minimize",type:i.GET,isNativeMethod:!0})},setFullScreen:function(){return o({url:"window.setFullScreen",type:i.GET,isNativeMethod:!0})},exitFullScreen:function(){return o({url:"window.exitFullScreen",type:i.GET,isNativeMethod:!0})},isFullScreen:function(){return o({url:"window.isFullScreen",type:i.GET,isNativeMethod:!0})},show:function(){return o({url:"window.show",type:i.GET,isNativeMethod:!0})},hide:function(){return o({url:"window.hide",type:i.GET,isNativeMethod:!0})},isVisible:function(){return o({url:"window.isVisible",type:i.GET,isNativeMethod:!0})},focus:function(){return o({url:"window.focus",type:i.GET,isNativeMethod:!0})},setIcon:function(e){return o({url:"window.setIcon",type:i.POST,isNativeMethod:!0,data:{icon:e}})},move:function(e,t){return o({url:"window.move",type:i.POST,isNativeMethod:!0,data:{x:e,y:t}})},setDraggableRegion:function(e){return new Promise(((n,i)=>{let r=document.getElementById(e),o=0,a=0;function u(e){return t(this,void 0,void 0,(function*(){yield Neutralino.window.move(e.screenX-o,e.screenY-a)}))}r||i(`Unable to find dom element: #${e}`),r.addEventListener("pointerdown",(e=>{o=e.clientX,a=e.clientY,r.addEventListener("pointermove",u),r.setPointerCapture(e.pointerId)})),r.addEventListener("pointerup",(e=>{r.removeEventListener("pointermove",u),r.releasePointerCapture(e.pointerId)})),n()}))},setSize:function(e){return o({url:"window.setSize",type:i.POST,isNativeMethod:!0,data:e})},create:function(e,t){return new Promise(((n,i)=>{function r(e){return"string"!=typeof e||(e=e.trim()).includes(" ")&&(e=`"${e}"`),e}let o=window.NL_ARGS.reduce(((e,t,n)=>((t.includes("--path=")||t.includes("--debug-mode")||t.includes("--load-dir-res")||0==n)&&(e+=" "+r(t)),e)),"");o+=" --url="+r(e);for(let e in t){if("processArgs"==e)continue;o+=` --window${e.replace(/[A-Z]|^[a-z]/g,(e=>"-"+e.toLowerCase()))}=${r(t[e])}`}t.processArgs&&(o+=" "+t.processArgs),Neutralino.os.execCommand({command:o,shouldRunInBackground:!0}).then((()=>{n()})).catch((e=>{i(e)}))}))}});let w=()=>{setInterval((()=>t(void 0,void 0,void 0,(function*(){try{yield f()}catch(e){console.error("Unable to keep Neutralino server online. The server is not reachable.")}}))),5e3)},y={start:function(){setInterval((()=>t(this,void 0,void 0,(function*(){try{(yield o({url:"http://localhost:5050",type:i.GET})).needsReload&&location.reload()}catch(e){console.error("Unable to communicate with neu devServer")}}))),1e3)}};return e.app=v,e.computer=d,e.debug=p,e.events=r,e.filesystem=u,e.init=function(){if(window.NL_MODE&&"browser"==window.NL_MODE&&w(),void 0!==window.NL_ARGS)for(let e=0;e<window.NL_ARGS.length;e++)if("--debug-mode"==window.NL_ARGS[e]){y.start();break}window.NL_CVERSION="1.5.0"},e.os=s,e.storage=c,e.window=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
